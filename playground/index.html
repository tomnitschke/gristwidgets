<html>
<head>
  <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/themes/light.css" />
  <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/shoelace-autoloader.js"></script>

  <script type="module" src="./index.js"></script>

  <style>
    :not(:defined) { visibility: hidden; }
    html, body { margin:0; padding:0; var(--grist-theme-medium-font-size); font-family: var(--grist-theme-font-family); }
    sl-dialog::part(close-button) { display: none; }
    #configContainer { display:flex; flex-direction:column; row-gap:var(--sl-spacing-small); }
    #content { height:100%;width:100%;border:solid 1px var(--grist-theme-widget-border);box-sizing:border-box; }
    #reloadBtn { position:absolute; z-index:9999; bottom:10px; left:10px; }
    #configOpenBtn { position:absolute; z-index:9999; bottom:10px; right:10px; }
  </style>
</head>
<body>
  <div id="status">Please allow 'full' document access for this widget.</div>
  <sl-button id="reloadBtn" size="small" variant="neutral" outline style="display:none;">
    <sl-icon slot="prefix" name="arrow-clockwise"></sl-icon>
    Reload Playground
  </sl-button>
  <sl-button id="configOpenBtn" size="small" variant="neutral" outline style="display:none;">
    <sl-icon slot="prefix" name="gear"></sl-icon>
    Playground Config
  </sl-button>
  <sl-dialog id="config" label="Config">
    <div id="configContainer">
      <sl-checkbox class="configItem" id="config_enableButtons" size="small" help-text="Show the 'Reload Playground' and 'Playground Settings' buttons. WARNING: If you hide these, the only way to edit these settings (and get them back) is to manually edit the settings JSON stored on the Grist record.">Enable playground buttons</sl-checkbox>
      <sl-checkbox class="configItem" id="config_enableAutoreload" size="small">Enable auto-reload</sl-checkbox>
      <sl-checkbox class="configItem" id="config_importGristThemeCSSVars" size="small">Import Grist theme CSS vars into loaded content</sl-checkbox>
      <sl-textarea class="configItem" id="config_jsPrelude" label="Default JS content">
        <p slot="help-text">Any JS code defined here will always be inserted into the playground, regardless of what user content gets loaded. This code will get loaded before any user code.</p>
      </sl-textarea>
      <sl-textarea class="configItem" id="config_htmlPrelude" label="Default HTML content">
        <p slot="help-text">Any HTML markup defined here will always be inserted into the playground, regardless of what user content gets loaded. This markup will be inserted before any user markup.</p>
      </sl-textarea>
    </div>
    <sl-button-group slot="footer">
      <sl-button id="configResetBtn" size="small">Reset</sl-button>
      <sl-button size="small" variant="primary" onclick="document.querySelector('#config').hide();">Close</sl-button>
    </sl-button-group>
  </sl-dialog>
  <iframe id="content"></iframe>
</body>
</html>
